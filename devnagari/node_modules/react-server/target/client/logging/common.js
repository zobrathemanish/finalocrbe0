'use strict';

var stats = require('./stats');

// These are the primary log levels.
// Your logger object has a method for each of these.
var LOG_LEVELS = {
	emergency: 0,
	alert: 1,
	critical: 2,
	error: 3,
	warning: 4,
	notice: 5,
	info: 6,
	debug: 7

	// Need these to be shared across react-server (can actually be modified
	// by the logging modules).
};var config = global._REACT_SERVER_CONFIG || (global._REACT_SERVER_CONFIG = {
	main: {
		baseLevel: 'error',
		levels: LOG_LEVELS,
		colors: {
			emergency: 'red',
			alert: 'red',
			critical: 'red',
			error: 'red',
			warning: 'yellow',
			notice: 'yellow',
			info: 'green',
			debug: 'blue'
		}
	},

	// This config is for an internal logger used by the `time` method.
	time: {
		// TODO: Some day, when slow times are rare, we should set
		// this to 'slow' in production to surface performance issues.
		baseLevel: 'none',
		levels: {
			none: 0, // Not used.  Disables in production.
			slow: 1,
			fine: 2,
			fast: 3
		},
		colors: {
			slow: 'red',
			fine: 'yellow',
			fast: 'green'
		}
	},

	// This config is for an internal logger used by the `gauge` method.
	gauge: {
		// TODO: Some day, when abnormal values are rare, we should
		// set this to 'lo' in production to surface issues.
		baseLevel: 'no',
		levels: {
			no: 0, // Not used.  Disables in production.
			hi: 1,
			lo: 2,
			ok: 3
		},
		colors: {
			hi: 'red',
			lo: 'red',
			ok: 'green'
		}
	}
});

// These need to be shared across react-server.
var loggers = global._REACT_SERVER_LOGGERS || (global._REACT_SERVER_LOGGERS = {});

// We may have loggers with the same name in different groups, so we'll give
// each group its own container.
if (!Object.keys(loggers).length) {
	for (var group in config) {
		if (!config.hasOwnProperty(group)) continue;
		loggers[group] = {};
	}
}

// This is just a cache.
// Don't want to instantiate a given logger more than once.
var getLoggerForConfig = function getLoggerForConfig(makeLogger) {
	return function (group, opts) {
		return loggers[group][opts.name] || (loggers[group][opts.name] = makeLogger(group, opts));
	};
};

// This is a helper function that takes an internal `makeLogger`
// function and produces a public `getLogger` function.  The produced
// `getLogger` function calls the provided `makeLogger` function for
// each of our two loggers and then stitches the stats logger onto the main
// logger.
var makeGetLogger = function makeGetLogger(makeLogger) {
	return function (opts) {
		return stats.getCombinedLogger(getLoggerForConfig(makeLogger), opts);
	};
};

// Just a handy helper for iteration.
var forEachLogger = function forEachLogger(callback) {
	return Object.keys(config).forEach(function (group) {
		Object.keys(loggers[group]).forEach(function (logger) {
			callback(loggers[group][logger], group);
		});
	});
};

// Return a stack trace.  Strip `strip` extra frames off (optional).
function stack() {
	var strip = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;


	// No stack property on Error objects in ie9, unfortunately.
	// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/Stack
	return (new Error().stack || '').split("\n").slice(2 + strip).join("\n");
}

module.exports = { config: config, loggers: loggers, stack: stack, makeGetLogger: makeGetLogger, forEachLogger: forEachLogger };
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2dpbmcvY29tbW9uLmpzIl0sIm5hbWVzIjpbInN0YXRzIiwicmVxdWlyZSIsIkxPR19MRVZFTFMiLCJlbWVyZ2VuY3kiLCJhbGVydCIsImNyaXRpY2FsIiwiZXJyb3IiLCJ3YXJuaW5nIiwibm90aWNlIiwiaW5mbyIsImRlYnVnIiwiY29uZmlnIiwiZ2xvYmFsIiwiX1JFQUNUX1NFUlZFUl9DT05GSUciLCJtYWluIiwiYmFzZUxldmVsIiwibGV2ZWxzIiwiY29sb3JzIiwidGltZSIsIm5vbmUiLCJzbG93IiwiZmluZSIsImZhc3QiLCJnYXVnZSIsIm5vIiwiaGkiLCJsbyIsIm9rIiwibG9nZ2VycyIsIl9SRUFDVF9TRVJWRVJfTE9HR0VSUyIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJncm91cCIsImhhc093blByb3BlcnR5IiwiZ2V0TG9nZ2VyRm9yQ29uZmlnIiwib3B0cyIsIm5hbWUiLCJtYWtlTG9nZ2VyIiwibWFrZUdldExvZ2dlciIsImdldENvbWJpbmVkTG9nZ2VyIiwiZm9yRWFjaExvZ2dlciIsImZvckVhY2giLCJjYWxsYmFjayIsImxvZ2dlciIsInN0YWNrIiwic3RyaXAiLCJFcnJvciIsInNwbGl0Iiwic2xpY2UiLCJqb2luIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxRQUFRQyxRQUFRLFNBQVIsQ0FBWjs7QUFFQTtBQUNBO0FBQ0EsSUFBSUMsYUFBYTtBQUNoQkMsWUFBWSxDQURJO0FBRWhCQyxRQUFZLENBRkk7QUFHaEJDLFdBQVksQ0FISTtBQUloQkMsUUFBWSxDQUpJO0FBS2hCQyxVQUFZLENBTEk7QUFNaEJDLFNBQVksQ0FOSTtBQU9oQkMsT0FBWSxDQVBJO0FBUWhCQyxRQUFZOztBQUdiO0FBQ0E7QUFaaUIsQ0FBakIsQ0FhQSxJQUFJQyxTQUFVQyxPQUFPQyxvQkFBUCxLQUFnQ0QsT0FBT0Msb0JBQVAsR0FBOEI7QUFDM0VDLE9BQU07QUFDTEMsYUFBVyxPQUROO0FBRUxDLFVBQVFk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ImxvZ2dpbmcvY29tbW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHN0YXRzID0gcmVxdWlyZSgnLi9zdGF0cycpXG5cbi8vIFRoZXNlIGFyZSB0aGUgcHJpbWFyeSBsb2cgbGV2ZWxzLlxuLy8gWW91ciBsb2dnZXIgb2JqZWN0IGhhcyBhIG1ldGhvZCBmb3IgZWFjaCBvZiB0aGVzZS5cbnZhciBMT0dfTEVWRUxTID0ge1xuXHRlbWVyZ2VuY3kgOiAwLFxuXHRhbGVydCAgICAgOiAxLFxuXHRjcml0aWNhbCAgOiAyLFxuXHRlcnJvciAgICAgOiAzLFxuXHR3YXJuaW5nICAgOiA0LFxuXHRub3RpY2UgICAgOiA1LFxuXHRpbmZvICAgICAgOiA2LFxuXHRkZWJ1ZyAgICAgOiA3LFxufVxuXG4vLyBOZWVkIHRoZXNlIHRvIGJlIHNoYXJlZCBhY3Jvc3MgcmVhY3Qtc2VydmVyIChjYW4gYWN0dWFsbHkgYmUgbW9kaWZpZWRcbi8vIGJ5IHRoZSBsb2dnaW5nIG1vZHVsZXMpLlxudmFyIGNvbmZpZyA9IChnbG9iYWwuX1JFQUNUX1NFUlZFUl9DT05GSUcgfHwgKGdsb2JhbC5fUkVBQ1RfU0VSVkVSX0NPTkZJRyA9IHtcblx0bWFpbjoge1xuXHRcdGJhc2VMZXZlbDogJ2Vycm9yJyxcblx0XHRsZXZlbHM6IExPR19MRVZFTFMsXG5cdFx0Y29sb3JzOiB7XG5cdFx0XHRlbWVyZ2VuY3kgOiAncmVkJyxcblx0XHRcdGFsZXJ0ICAgICA6ICdyZWQnLFxuXHRcdFx0Y3JpdGljYWwgIDogJ3JlZCcsXG5cdFx0XHRlcnJvciAgICAgOiAncmVkJyxcblx0XHRcdHdhcm5pbmcgICA6ICd5ZWxsb3cnLFxuXHRcdFx0bm90aWNlICAgIDogJ3llbGxvdycsXG5cdFx0XHRpbmZvICAgICAgOiAnZ3JlZW4nLFxuXHRcdFx0ZGVidWcgICAgIDogJ2JsdWUnLFxuXHRcdH0sXG5cdH0sXG5cblx0Ly8gVGhpcyBjb25maWcgaXMgZm9yIGFuIGludGVybmFsIGxvZ2dlciB1c2VkIGJ5IHRoZSBgdGltZWAgbWV0aG9kLlxuXHR0aW1lOiB7XG5cdFx0Ly8gVE9ETzogU29tZSBkYXksIHdoZW4gc2xvdyB0aW1lcyBhcmUgcmFyZSwgd2Ugc2hvdWxkIHNldFxuXHRcdC8vIHRoaXMgdG8gJ3Nsb3cnIGluIHByb2R1Y3Rpb24gdG8gc3VyZmFjZSBwZXJmb3JtYW5jZSBpc3N1ZXMuXG5cdFx0YmFzZUxldmVsOiAnbm9uZScsXG5cdFx0bGV2ZWxzOiB7XG5cdFx0XHRub25lOiAwLCAvLyBOb3QgdXNlZC4gIERpc2FibGVzIGluIHByb2R1Y3Rpb24uXG5cdFx0XHRzbG93OiAxLFxuXHRcdFx0ZmluZTogMixcblx0XHRcdGZhc3Q6IDMsXG5cdFx0fSxcblx0XHRjb2xvcnM6IHtcblx0XHRcdHNsb3c6ICdyZWQnLFxuXHRcdFx0ZmluZTogJ3llbGxvdycsXG5cdFx0XHRmYXN0OiAnZ3JlZW4nLFxuXHRcdH0sXG5cdH0sXG5cblx0Ly8gVGhpcyBjb25maWcgaXMgZm9yIGFuIGludGVybmFsIGxvZ2dlciB1c2VkIGJ5IHRoZSBgZ2F1Z2VgIG1ldGhvZC5cblx0Z2F1Z2U6IHtcblx0XHQvLyBUT0RPOiBTb21lIGRheSwgd2hlbiBhYm5vcm1hbCB2YWx1ZXMgYXJlIHJhcmUsIHdlIHNob3VsZFxuXHRcdC8vIHNldCB0aGlzIHRvICdsbycgaW4gcHJvZHVjdGlvbiB0byBzdXJmYWNlIGlzc3Vlcy5cblx0XHRiYXNlTGV2ZWw6ICdubycsXG5cdFx0bGV2ZWxzOiB7XG5cdFx0XHRubzogMCwgLy8gTm90IHVzZWQuICBEaXNhYmxlcyBpbiBwcm9kdWN0aW9uLlxuXHRcdFx0aGk6IDEsXG5cdFx0XHRsbzogMixcblx0XHRcdG9rOiAzLFxuXHRcdH0sXG5cdFx0Y29sb3JzOiB7XG5cdFx0XHRoaTogJ3JlZCcsXG5cdFx0XHRsbzogJ3JlZCcsXG5cdFx0XHRvazogJ2dyZWVuJyxcblx0XHR9LFxuXHR9LFxufSkpO1xuXG4vLyBUaGVzZSBuZWVkIHRvIGJlIHNoYXJlZCBhY3Jvc3MgcmVhY3Qtc2VydmVyLlxudmFyIGxvZ2dlcnMgPSAoZ2xvYmFsLl9SRUFDVF9TRVJWRVJfTE9HR0VSUyB8fCAoZ2xvYmFsLl9SRUFDVF9TRVJWRVJfTE9HR0VSUyA9IHt9KSk7XG5cbi8vIFdlIG1heSBoYXZlIGxvZ2dlcnMgd2l0aCB0aGUgc2FtZSBuYW1lIGluIGRpZmZlcmVudCBncm91cHMsIHNvIHdlJ2xsIGdpdmVcbi8vIGVhY2ggZ3JvdXAgaXRzIG93biBjb250YWluZXIuXG5pZiAoIU9iamVjdC5rZXlzKGxvZ2dlcnMpLmxlbmd0aCl7XG5cdGZvciAodmFyIGdyb3VwIGluIGNvbmZpZyl7XG5cdFx0aWYgKCFjb25maWcuaGFzT3duUHJvcGVydHkoZ3JvdXApKSBjb250aW51ZTtcblx0XHRsb2dnZXJzW2dyb3VwXSA9IHt9O1xuXHR9XG59XG5cbi8vIFRoaXMgaXMganVzdCBhIGNhY2hlLlxuLy8gRG9uJ3Qgd2FudCB0byBpbnN0YW50aWF0ZSBhIGdpdmVuIGxvZ2dlciBtb3JlIHRoYW4gb25jZS5cbnZhciBnZXRMb2dnZXJGb3JDb25maWcgPSBtYWtlTG9nZ2VyID0+IHtcblx0cmV0dXJuIGZ1bmN0aW9uKGdyb3VwLCBvcHRzKXtcblx0XHRyZXR1cm4gbG9nZ2Vyc1tncm91cF1bb3B0cy5uYW1lXSB8fCAoXG5cdFx0XHRsb2dnZXJzW2dyb3VwXVtvcHRzLm5hbWVdID0gbWFrZUxvZ2dlcihncm91cCwgb3B0cylcblx0XHQpO1xuXHR9XG59XG5cbi8vIFRoaXMgaXMgYSBoZWxwZXIgZnVuY3Rpb24gdGhhdCB0YWtlcyBhbiBpbnRlcm5hbCBgbWFrZUxvZ2dlcmBcbi8vIGZ1bmN0aW9uIGFuZCBwcm9kdWNlcyBhIHB1YmxpYyBgZ2V0TG9nZ2VyYCBmdW5jdGlvbi4gIFRoZSBwcm9kdWNlZFxuLy8gYGdldExvZ2dlcmAgZnVuY3Rpb24gY2FsbHMgdGhlIHByb3ZpZGVkIGBtYWtlTG9nZ2VyYCBmdW5jdGlvbiBmb3Jcbi8vIGVhY2ggb2Ygb3VyIHR3byBsb2dnZXJzIGFuZCB0aGVuIHN0aXRjaGVzIHRoZSBzdGF0cyBsb2dnZXIgb250byB0aGUgbWFpblxuLy8gbG9nZ2VyLlxudmFyIG1ha2VHZXRMb2dnZXIgPSBtYWtlTG9nZ2VyID0+IChcblx0b3B0cyA9PiBzdGF0cy5nZXRDb21iaW5lZExvZ2dlcihnZXRMb2dnZXJGb3JDb25maWcobWFrZUxvZ2dlciksIG9wdHMpXG4pO1xuXG4vLyBKdXN0IGEgaGFuZHkgaGVscGVyIGZvciBpdGVyYXRpb24uXG52YXIgZm9yRWFjaExvZ2dlciA9IGNhbGxiYWNrID0+IE9iamVjdC5rZXlzKGNvbmZpZykuZm9yRWFjaChncm91cCA9PiB7XG5cdE9iamVjdC5rZXlzKGxvZ2dlcnNbZ3JvdXBdKS5mb3JFYWNoKGxvZ2dlciA9PiB7XG5cdFx0Y2FsbGJhY2sobG9nZ2Vyc1tncm91cF1bbG9nZ2VyXSwgZ3JvdXApO1xuXHR9KTtcbn0pO1xuXG4vLyBSZXR1cm4gYSBzdGFjayB0cmFjZS4gIFN0cmlwIGBzdHJpcGAgZXh0cmEgZnJhbWVzIG9mZiAob3B0aW9uYWwpLlxuZnVuY3Rpb24gc3RhY2soc3RyaXA9MCl7XG5cblx0Ly8gTm8gc3RhY2sgcHJvcGVydHkgb24gRXJyb3Igb2JqZWN0cyBpbiBpZTksIHVuZm9ydHVuYXRlbHkuXG5cdC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yL1N0YWNrXG5cdHJldHVybiAobmV3IEVycm9yKCkuc3RhY2sgfHwgJycpLnNwbGl0KFwiXFxuXCIpLnNsaWNlKDIrc3RyaXApLmpvaW4oXCJcXG5cIilcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGNvbmZpZywgbG9nZ2Vycywgc3RhY2ssIG1ha2VHZXRMb2dnZXIsIGZvckVhY2hMb2dnZXIgfTtcbiJdfQ==
